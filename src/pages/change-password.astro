---
// --- IMPORTS ---
import plmLogo from "../assets/PLMLogo.webp";
import "../styles/global.css";
import { Image } from "astro:assets";

// --- 1. TYPE DEFINITIONS ---
interface StudentProfile {
    firstName: string;
    lastName: string;
    studentId: string;
}

// --- 2. FETCH DATA (SIMULATED) ---
async function fetchStudentProfile(): Promise<StudentProfile> {
    return {
        firstName: "JUAN",
        lastName: "CRUZ",
        studentId: "2024-xxxxx"
    };
}

const studentData = await fetchStudentProfile();
---

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PLM Student Portal - Change Password</title>
    <link rel="icon" href={plmLogo.src} />
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body class="bg-white font-sans min-h-screen flex flex-col text-gray-800">

    <!-- HEADER SECTION -->
    <header class="w-full bg-white shadow-sm z-50">
        <div class="flex justify-center py-4">
            <div class="w-15 h-15">
                 <Image src={plmLogo} alt="PLM Logo" class="w-full h-full object-contain" loading="eager" />
            </div>
        </div>
<div class="h-5 w-full bg-plm-navy border-b-9 border-[#991B1B]"></div>
        <nav class="border-y border-gray-200 py-2">
            <div class="max-w-7xl mx-auto px-4 flex justify-around md:justify-center md:gap-12 text-sm font-medium text-gray-700">
                <a href="/dashboard" class="px-6 py-2 rounded hover:text-plm-navy hover:bg-plm-navy/10 transition-all">Home</a>
                <a href="/student_schedule" class="px-6 py-2 rounded hover:text-plm-navy hover:bg-plm-navy/10 transition-all">Schedule</a>
                <a href="/grade" class="px-6 py-2 rounded hover:text-plm-navy hover:bg-plm-navy/20 transition-all">Grade</a>
                <a href="/enrollment" class="px-6 py-2 rounded hover:text-plm-navy hover:bg-plm-navy/10 transition-all">Enrollment</a>
                <a href="/personalinfo" class="px-6 py-2 rounded hover:text-plm-navy hover:bg-plm-navy/10 transition-all">Personal Info</a>
                <a href="/change-password" class="bg-plm-navy text-white px-6 py-2 rounded shadow-sm hover:bg-opacity-90 transition-all">Change Password</a>
            </div>
        </nav>

        <div class="bg-white border-b border-plm-gold/50 py-2">
            <div class="max-w-7xl mx-auto px-4 flex justify-between items-center text-sm">
                <span class="text-gray-800">
                    Signed in as: <span class="font-bold uppercase">{studentData.lastName}, {studentData.firstName}</span> <span class="font-bold">({studentData.studentId})</span>
                </span>
                <button class="text-[#991B1B] font-bold hover:underline text-xs tracking-wide">SIGN OUT</button>
            </div>
        </div>
    </header>

    <!-- MAIN CONTENT -->
    <main class="flex-grow w-full max-w-4xl mx-auto p-6 md:p-8 flex flex-col items-center">
        
        <h1 class="text-center text-2xl font-bold text-plm-navy mb-4 uppercase tracking-wide">CHANGE PASSWORD</h1>
        
        <p class="text-center text-gray-600 text-sm mb-10 max-w-3xl leading-relaxed">
            Choose a strong password and do not reuse it for other accounts. Use minimum of 8 characters: should contain capital, small letters, symbol and number.
        </p>

        <form class="w-full max-w-lg space-y-6">
            
            <!-- Current Password -->
            <div class="flex flex-col gap-1">
                <label class="text-xs text-gray-600 font-bold ml-1">Current Password</label>
                <div class="relative">
                    <input type="password" id="current-password" class="w-full border border-[#B8860B] rounded px-3 py-2.5 text-gray-800 bg-white focus:outline-none focus:ring-1 focus:ring-[#B8860B] pr-10" />
                    <!-- Toggle Button positioned absolutely inside the input -->
                    <button type="button" onclick="togglePassword('current-password', this)" class="absolute inset-y-0 right-0 flex items-center px-3 text-gray-500 hover:text-plm-navy transition-colors focus:outline-none">
                        <!-- Eye Icon (Closed by default) -->
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21" />
                        </svg>
                    </button>
                </div>
            </div>

            <!-- New Password -->
            <div class="flex flex-col gap-1">
                <label class="text-xs text-gray-600 font-bold ml-1">New Password</label>
                <div class="relative">
                    <input type="password" id="new-password" class="w-full border border-[#B8860B] rounded px-3 py-2.5 text-gray-800 bg-white focus:outline-none focus:ring-1 focus:ring-[#B8860B] pr-10" />
                    <button type="button" onclick="togglePassword('new-password', this)" class="absolute inset-y-0 right-0 flex items-center px-3 text-gray-500 hover:text-plm-navy transition-colors focus:outline-none">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21" />
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Confirm New Password -->
            <div class="flex flex-col gap-1">
                <label class="text-xs text-gray-600 font-bold ml-1">Confirm New Password</label>
                <div class="relative">
                    <input type="password" id="confirm-password" class="w-full border border-[#B8860B] rounded px-3 py-2.5 text-gray-800 bg-white focus:outline-none focus:ring-1 focus:ring-[#B8860B] pr-10" />
                    <button type="button" onclick="togglePassword('confirm-password', this)" class="absolute inset-y-0 right-0 flex items-center px-3 text-gray-500 hover:text-plm-navy transition-colors focus:outline-none">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21" />
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Save Button -->
            <div class="pt-6">
                <button type="submit" class="w-full bg-[#1e1e2f] text-white font-bold py-3 rounded shadow-lg hover:bg-plm-navy transition-transform active:scale-95 text-sm tracking-wide">
                    Save New Password
                </button>
            </div>

        </form>

    </main>

    <!-- SCRIPT FOR TOGGLING PASSWORD VISIBILITY -->
    <script is:inline>
        function togglePassword(inputId, btn) {
            const input = document.getElementById(inputId);
            const icon = btn.querySelector('svg');
            
            if (input.type === "password") {
                input.type = "text";
                // Switch to Open Eye Icon
                icon.innerHTML = `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />`;
            } else {
                input.type = "password";
                // Switch back to Closed Eye Icon
                icon.innerHTML = `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21" />`;
            }
        }
    </script>

</body>
</html>